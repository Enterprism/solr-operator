# Licensed to the Apache Software Foundation (ASF) under one or more
# contributor license agreements.  See the NOTICE file distributed with
# this work for additional information regarding copyright ownership.
# The ASF licenses this file to You under the Apache License, Version 2.0
# (the "License"); you may not use this file except in compliance with
# the License.  You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

apiVersion: v2
name: solr-operator
description: The Solr Operator enables easy management of Solr resources within Kubernetes.
version: 0.3.0-prerelease
appVersion: v0.3.0-prerelease
kubeVersion: ">= 1.16.0-0"
home: https://github.com/apache/solr-operator
sources:
  - https://github.com/apache/solr-operator
keywords:
  - solr
  - apache
  - search
  - lucene
  - operator
maintainers:
  - name: Solr Dev Community
    email: dev@solr.apache.org
  - name: Houston Putman
    email: houston@apache.org
icon: https://solr.apache.org/theme/images/identity/Solr_Logo_on_white.png
dependencies:
  - name: 'zookeeper-operator'
    version: 0.2.9
    repository: https://charts.pravega.io
    condition: zookeeper-operator.install
annotations:
  artifacthub.io/operator: "true"
  artifacthub.io/operatorCapabilities: Seamless Upgrades
  artifacthub.io/prerelease: "true"
  # Add change log for a single release here, only single-layered bulleted list allowed.
  artifacthub.io/changes: |
    - The Solr Operator is now an Apache project managed by the Apache Solr PMC.
    - The Solr CRDs now use the solr.apache.org API group instead of solr.bloomberg.com.
    - The Solr Operator now fully supports running Solr in a secure and locked down way:
    - Basic Auth support is now built in when requested in the SolrCloud CRD
    - Solr can be run with TLS (optional mTLS, if provided to the operator)
    - More helm chart options are provided to customize running the Solr Operator
    - The Zookeeper Operator is now up-to-date with the most recent release, v0.2.9.
      It can now be installed as a helm-chart dependency with the Solr Operator.
    - Users can now provide custom Solr log4j.xml and Prometheus Exporter config xml configMaps
    - Fix bug in custom probes for Solr pods
    - Solr pod shutdown is more graceful, has better coordination between Kubernetes and Solr.
    - SolrCloud can now be used with the Kubernetes HPA to autoscale Solr Cloud pods.
  artifacthub.io/images: |
    - name: solr-operator
      image: apache/solr-operator:v0.3.0-prerelease
  artifacthub.io/crds: |
    - kind: SolrCloud
      version: v1beta1
      name: solrcloud.solr.apache.org
      displayName: Solr Cloud
      description: A distributed Solr Cloud cluster
    - kind: SolrPrometheusExporter
      version: v1beta1
      name: solrprometheusexporter.solr.apache.org
      displayName: Solr Prometheus Exporter
      description: A Prometheus metrics exporter for Solr
    - kind: SolrBackup
      version: v1beta1
      name: solrbackup.solr.apache.org
      displayName: Solr Backup
      description: A backup mechanism for Solr
  artifacthub.io/crdsExamples: |
    - apiVersion: solr.apache.org/v1beta1
      kind: SolrCloud
      metadata:
        name: example
      spec:
        dataStorage:
          persistent:
            reclaimPolicy: Delete
            pvcTemplate:
              spec:
                resources:
                  requests:
                    storage: "20Gi"
        replicas: 3
        solrImage:
          tag: 8.7.0
        solrJavaMem: "-Xms4g -Xmx4g"
        customSolrKubeOptions:
          podOptions:
            resources:
              requests:
                memory: "6G"
        zookeeperRef:
          provided:
            replicas: 3
        solrOpts: "-Dsolr.autoSoftCommit.maxTime=10000"
        solrGCTune: "-XX:SurvivorRatio=4 -XX:TargetSurvivorRatio=90 -XX:MaxTenuringThreshold=8"
    - apiVersion: solr.apache.org/v1beta1
      kind: SolrPrometheusExporter
      metadata:
        name: example
      spec:
        solrReference:
          cloud:
            name: "example"
        numThreads: 4
        image:
          tag: 8.7.0
